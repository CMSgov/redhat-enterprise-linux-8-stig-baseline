---
verifier:
  name: inspec
  sudo: true
  reporter:
    - cli
    - json:spec/results/%{platform}_%{suite}.json
  inspec_tests:
    - name: Red Hat 8 STIG
      path: .
  controls:
    # Controls Currently Failing
    - SV-230223
    - SV-230224
    - SV-230233
    - SV-230234
    - SV-230251
    - SV-230252
    - SV-230263
    - SV-230267
    - SV-230268
    - SV-230271
    - SV-230285
    - SV-230289
    - SV-230292
    - SV-230293
    - SV-230294
    - SV-230295
    - SV-230299
    - SV-230302
    - SV-230304
    - SV-230316
    - SV-230317
    - SV-230325
    - SV-230328
    - SV-230330
    - SV-230349
    - SV-230351
    - SV-230355
    - SV-230356
    - SV-230364
    - SV-230367
    - SV-230368
    - SV-230379
    - SV-230380
    - SV-230381
    - SV-230391
    - SV-230412
    - SV-230494
    - SV-230495
    - SV-230496
    - SV-230497
    - SV-230500
    - SV-230511
    - SV-230512
    - SV-230513
    - SV-230514
    - SV-230515
    - SV-230516
    - SV-230517
    - SV-230518
    - SV-230519
    - SV-230520
    - SV-230521
    - SV-230522
    - SV-230524
    - SV-230537
    - SV-237642
    - SV-237643
    - SV-244520
    - SV-244521
    - SV-244529
    - SV-244546
    - SV-244553
    - SV-245540
  input_files:
    - kitchen.inputs.yml
  load_plugins: true

platforms:
  - name: rhel-8

suites:
  - name: vanilla
    provisioner:
      playbook: spec/ansible/roles/ansible-role-rhel-vanilla.yml
  - name: hardened
    provisioner:
      playbook: spec/ansible/roles/ansible-role-rhel-hardened.yml
